(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f7678af"],{"3aab":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var s=n("acc5"),o=n("4d28"),c=n.n(o);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(){function e(t){i(this,e),u(this,"dimensions",["lng","lat"]),u(this,"radians",s["P"].toRadians(80)),this._GLMap=t,this._mapOffset=[0,0],this.dimensions=["lng","lat"]}return a(e,[{key:"setMapOffset",value:function(e){this._mapOffset=e}},{key:"getMap",value:function(){return this._GLMap}},{key:"fixLat",value:function(e){return e>=90?89.99999999999999:e<=-90?-89.99999999999999:e}},{key:"dataToPoint",value:function(e){var t=[99999,99999];e[1]=this.fixLat(e[1]);var n=s["e"].fromDegrees(e[0],e[1]);if(!n)return t;var i=this._GLMap.cartesianToCanvasCoordinates(n);return i?!(this._GLMap.mode===s["db"].SCENE3D&&s["e"].angleBetween(this._GLMap.camera.position,n)>this.radians)&&[i.x-this._mapOffset[0],i.y-this._mapOffset[1]]:t}},{key:"pointToData",value:function(e){this._mapOffset;var t=this._bmap.project([e[0]+e[0],e[1]+e[1]]);return[t.lng,t.lat]}},{key:"getViewRect",value:function(){var e=this._api;return new c.a.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())}},{key:"getRoamTransform",value:function(){return c.a.matrix.create()}},{key:"create",value:function(t,n){var i;this._api=n,t.eachComponent("GLMap",(function(t){var r=n.getZr().painter;if(r){var a=c.a.glMap;i=new e(a,n),i.setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=i}})),t.eachSeries((function(e){"GLMap"===e.get("coordinateSystem")&&(e.coordinateSystem=i)}))}}]),e}(),l=h;console.log(c.a);var d=function(){function e(t,n){i(this,e),this._viewer=t,this._isRegistered=!1,this._chartLayer=this._createLayerContainer(),this.option=n,this._chartLayer.setOption(n)}return a(e,[{key:"_createLayerContainer",value:function(){var e=this._viewer.scene,t=document.createElement("div");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.right="0px",t.style.bottom="0px",t.style.width=e.canvas.width+"px",t.style.height=e.canvas.height+"px",t.style.pointerEvents="none",this._viewer.container.appendChild(t),this._echartsContainer=t,c.a.glMap=e,this._register(),c.a.init(t)}},{key:"_register",value:function(){this._isRegistered||(c.a.registerCoordinateSystem("GLMap",new l(c.a.glMap)),c.a.registerAction({type:"GLMapRoam",event:"GLMapRoam",update:"updateLayout"},(function(e,t){})),c.a.extendComponentModel({type:"GLMap",getBMap:function(){return this.__GLMap},defaultOption:{roam:!1}}),c.a.extendComponentView({type:"GLMap",init:function(e,t){this.api=t,c.a.glMap.postRender.addEventListener(this.moveHandler,this)},moveHandler:function(e,t){this.api.dispatchAction({type:"GLMapRoam"})},render:function(e,t,n){},dispose:function(){c.a.glMap.postRender.removeEventListener(this.moveHandler,this)}}),this._isRegistered=!0)}},{key:"dispose",value:function(){this._echartsContainer&&(this._viewer.container.removeChild(this._echartsContainer),this._echartsContainer=null),this._chartLayer&&(this._chartLayer.dispose(),this._chartLayer=null),this._isRegistered=!1}},{key:"destroy",value:function(){this.dispose()}},{key:"updateEchartsLayer",value:function(e){this._chartLayer&&this._chartLayer.setOption(e)}},{key:"getMap",value:function(){return this._viewer}},{key:"getEchartsLayer",value:function(){return this._chartLayer}},{key:"show",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="visible")}},{key:"hide",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="hidden")}}]),e}();s["EchartsLayer"]=d},"8b75":function(e,t,n){},cb4e:function(e,t,n){"use strict";n("8b75")},f424:function(e,t,n){"use strict";n.r(t);var i,r=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"cesiumContainer1"}},[n("div",{attrs:{id:"cesiumContainer"}}),n("div",{attrs:{id:"ThreeContainer"}})])}],s=(n("3610"),n("c585"),n("acc5")),o=n("3bc2"),c=(n("5b17"),n("3aab"),[115.23,39.55]),u=[116.23,41.55],h=[],l={renderer:null,camera:null,scene:null},d={viewer:null},p={props:{},data:function(){return{publicPath:""}},mounted:function(){this.main()},methods:{main:function(){s["J"].defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmMjY1MzY3MC1mYWIwLTQ2ZDItYTdlZi0yNWEyZjU2MjAzOTQiLCJpZCI6Mzg4MzUsImlhdCI6MTYwNjg3MzkxNX0.gGDAumUmOxcrCTMRfrKZJjfZpYiLxGwJwSLlkDYt9BY",document.getElementById("cesiumContainer"),i=document.getElementById("ThreeContainer"),this.initCesium(),this.initThree(),this.init3DObject(),this.loop()},initCesium:function(){new s["a"]({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),new s["nb"]({url:"http://mt1.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&{x}&y={y}&z={z}&s=Gali"});d.viewer=new s["rb"]("cesiumContainer",{infoBox:!1,selectionIndicator:!1,geocoder:!1,homeButton:!1,timeline:!1,navigationHelpButton:!1,fullscreenButton:!1,scene3DOnly:!0,animation:!1,imageryProvider:new s["a"]({url:"http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer"}),baseLayerPicker:!1});var e=s["e"].fromDegrees((c[0]+u[0])/2,(c[1]+u[1])/2-1,2e5);e,d.viewer.camera.flyTo({destination:e,orientation:{heading:s["P"].toRadians(0),pitch:s["P"].toRadians(-60),roll:s["P"].toRadians(0)},duration:3})},initThree:function(){var e=45,t=window.innerWidth,n=window.innerHeight,r=t/n,a=1,s=1e7;l.scene=new o["nb"],l.camera=new o["eb"](e,r,a,s),l.renderer=new o["Hb"]({alpha:!0}),l.scene.add(new o["b"](new o["n"]("#666666"))),i.appendChild(l.renderer.domElement)},init3DObject:function(){var e={name:"Polygon",polygon:{hierarchy:s["e"].fromDegreesArray([c[0],c[1],u[0],c[1],u[0],u[1],c[0],u[1]]),material:s["q"].RED.withAlpha(0)}},t=(d.viewer.entities.add(e),this.createMesh());t.scale.set(1500,1500,1500),t.position.z+=15,t.rotation.x=Math.PI/2;var n=new o["w"];n.add(t),l.scene.add(n);var i=new r;function r(){this.threeMesh=null,this.minWGS84=null,this.maxWGS84=null}i.threeMesh=n,i.minWGS84=c,i.maxWGS84=u,h.push(i)},createMesh:function(){var e=new o["g"](20,20,20),t=new o["U"]({color:16777215*Math.random()}),n=new o["S"](e,t);function i(){var e=.001*performance.now();n.position.z=15e3*Math.sin(e)+1500,n.rotation.y=.5*e,requestAnimationFrame(i)}return i(),n},getTexture:function(){var e=this;return new Promise((function(t,n){(new o["Ab"]).load("".concat(e.publicPath,"texture/nanshan-road1.png"),(function(e){t(e)}),void 0,void 0)}))},loop:function(){requestAnimationFrame(this.loop),this.renderCesium(),this.renderThreeObj()},renderCesium:function(){d.viewer.render()},renderThreeObj:function(){l.camera.fov=s["P"].toDegrees(d.viewer.camera.frustum.fovy);var e=function(e){return new o["Fb"](e.x,e.y,e.z)};h.forEach((function(t,n){c=h[n].minWGS84,u=h[n].maxWGS84;var i=s["e"].fromDegrees((c[0]+u[0])/2,(c[1]+u[1])/2),r=s["e"].fromDegrees((c[0]+u[0])/2,(c[1]+u[1])/2,1),a=e(s["e"].fromDegrees(c[0],c[1])),l=e(s["e"].fromDegrees(c[0],u[1])),d=(new o["Fb"]).subVectors(a,l).normalize();h[n].threeMesh.position.copy(i),h[n].threeMesh.lookAt(r.x,r.y,r.z),h[n].threeMesh.up.copy(d)})),l.camera.matrixAutoUpdate=!1;var t=d.viewer.camera.viewMatrix,n=d.viewer.camera.inverseViewMatrix;l.camera.lookAt(0,0,0),l.camera.matrixWorld.set(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]),l.camera.matrixWorldInverse.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]);var r=i.clientWidth,a=i.clientHeight,p=r/a;l.camera.aspect=p,l.camera.updateProjectionMatrix(),l.renderer.setSize(r,a),l.renderer.clear(),l.renderer.render(l.scene,l.camera)}}},f=p,m=(n("cb4e"),n("c701")),v=Object(m["a"])(f,r,a,!1,null,"7f6c4c1e",null);t["default"]=v.exports}}]);
//# sourceMappingURL=chunk-4f7678af.310153ae.js.map