(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b16eaf52"],{"118e":function(e,t,n){"use strict";n.r(t);var i,a=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"cesiumContainer1"}},[n("div",{attrs:{id:"cesiumContainer"}}),n("div",{attrs:{id:"ThreeContainer"}})])}],o=(n("3610"),n("acc5")),s=n("3bc2"),c=(n("5b17"),n("3aab"),[115.23,39.55]),l=[116.23,41.55],u=[],h={renderer:null,camera:null,scene:null},d={viewer:null},f={props:{},data:function(){return{}},mounted:function(){var e=document.createElement("script");e.type="x-shader/x-vertex",e.id="vertex-shader",e.src="//g.alicdn.com/sd/smartCaptcha/0.0.1/index.js",document.body.appendChild(e),this.main()},methods:{main:function(){o["J"].defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmMjY1MzY3MC1mYWIwLTQ2ZDItYTdlZi0yNWEyZjU2MjAzOTQiLCJpZCI6Mzg4MzUsImlhdCI6MTYwNjg3MzkxNX0.gGDAumUmOxcrCTMRfrKZJjfZpYiLxGwJwSLlkDYt9BY",document.getElementById("cesiumContainer"),i=document.getElementById("ThreeContainer"),this.initCesium(),this.initThree(),this.init3DObject(),this.loop()},initCesium:function(){new o["a"]({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),new o["nb"]({url:"http://mt1.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&{x}&y={y}&z={z}&s=Gali"});d.viewer=new o["rb"]("cesiumContainer",{infoBox:!1,selectionIndicator:!1,geocoder:!1,homeButton:!1,timeline:!1,navigationHelpButton:!1,fullscreenButton:!1,scene3DOnly:!0,animation:!1,imageryProvider:new o["a"]({url:"http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer"}),baseLayerPicker:!1});var e=o["e"].fromDegrees((c[0]+l[0])/2,(c[1]+l[1])/2-1,2e5);e,d.viewer.camera.flyTo({destination:e,orientation:{heading:o["P"].toRadians(0),pitch:o["P"].toRadians(-60),roll:o["P"].toRadians(0)},duration:3})},initThree:function(){var e=45,t=window.innerWidth,n=window.innerHeight,a=t/n,r=1,o=1e7;h.scene=new s["nb"],h.camera=new s["eb"](e,a,r,o),h.renderer=new s["Hb"]({alpha:!0}),i.appendChild(h.renderer.domElement)},init3DObject:function(){var e={name:"Polygon",polygon:{hierarchy:o["e"].fromDegreesArray([c[0],c[1],l[0],c[1],l[0],l[1],c[0],l[1]]),material:o["q"].RED.withAlpha(0)}},t=(d.viewer.entities.add(e),this.createMesh());t.scale.set(1500,1500,1500),t.position.z+=15,t.rotation.x=Math.PI/2;var n=new s["w"];n.add(t),h.scene.add(n);var i=new a;function a(){this.threeMesh=null,this.minWGS84=null,this.maxWGS84=null}i.threeMesh=n,i.minWGS84=c,i.maxWGS84=l,u.push(i)},createMesh:function(){var e={uniforms:{time:{value:0},u_speed:{value:1},u_radius:{value:100},u_width:{value:Math.PI/2},hightColor:{value:new s["n"]("#ff0000")}},vertexShaderSource:"varying vec3 v_position;\n                void main() {\n                    v_position = position;\n                }",fragmentShaderSource:"\n                float lerp (float x,float y,float t ) {\n                    return ( 1.0 - t ) * x + t * y;\n                }\n                float distanceTo(vec2 src, vec2 dst) {\n                    float dx = src.x - dst.x;\n                    float dy = src.y - dst.y;\n                    float dv = dx * dx + dy * dy;\n                    return sqrt(dv);\n                }\n                float atan2(float y, float x){\n                    float t0, t1, t2, t3, t4;\n                    t3 = abs(x);\n                    t1 = abs(y);\n                    t0 = max(t3, t1);\n                    t1 = min(t3, t1);\n                    t3 = float(1) / t0;\n                    t3 = t1 * t3;\n                    t4 = t3 * t3;\n                    t0 = -float(0.013480470);\n                    t0 = t0 * t4 + float(0.057477314);\n                    t0 = t0 * t4 - float(0.121239071);\n                    t0 = t0 * t4 + float(0.195635925);\n                    t0 = t0 * t4 - float(0.332994597);\n                    t0 = t0 * t4 + float(0.999995630);\n                    t3 = t0 * t3;\n                    t3 = (abs(y) > abs(x)) ? float(1.570796327) - t3 : t3;\n                    t3 = (x < 0.0) ?  float(3.141592654) - t3 : t3;\n                    t3 = (y < 0.0) ? -t3 : t3;\n                    return t3;\n                }\n\n                uniform vec3 hightColor;\n                uniform float u_speed;\n                uniform float u_radius;\n                uniform float u_width;\n                uniform float time;\n                varying vec3 v_position;\n                void main() {\n                    float u_time = u_speed * time;\n                vec2 curr = vec2(v_position.x, v_position.z);\n                float vLength = distanceTo(vec2(5.0, 0.0), curr);\n                \n                float len = mod(u_time, u_radius);\n\n                float vOpacity = diffuseColor.a;\n                vec3 vColor = outgoingLight; \n\n                float angle = atan2(v_position.x, v_position.z) + PI;\n                float angleT = mod(angle + u_time, PI2); \n               \n                float length = distanceTo(vec2(0.0, 0.0), curr);\n\n                float d_opacity = 1.0 - angleT / PI * (PI / u_width);\n\n                if (length > u_radius) { d_opacity = 0.0; };\n                vec3 rColor = vec3(1.0, 1.0, 1.0);\n                if (d_opacity > 0.0) {\n                    rColor = vec3(\n                        lerp(vColor.r, hightColor.r, d_opacity),\n                        lerp(vColor.g, hightColor.g, d_opacity),\n                        lerp(vColor.b, hightColor.b, d_opacity)\n                    );\n                }\n                gl_FragColor = vec4( vColor * rColor, d_opacity);}"},t=new s["pb"]({uniforms:e.uniforms,vertexShader:e.vertexShaderSource,fragmentShader:e.fragmentShaderSource}),n=new s["l"](1,12e3);return new s["S"](n,t)},loop:function(){requestAnimationFrame(this.loop),this.renderCesium(),this.renderThreeObj()},renderCesium:function(){d.viewer.render()},renderThreeObj:function(){h.camera.fov=o["P"].toDegrees(d.viewer.camera.frustum.fovy);var e=function(e){return new s["Fb"](e.x,e.y,e.z)};u.forEach((function(t,n){c=u[n].minWGS84,l=u[n].maxWGS84;var i=o["e"].fromDegrees((c[0]+l[0])/2,(c[1]+l[1])/2),a=o["e"].fromDegrees((c[0]+l[0])/2,(c[1]+l[1])/2,1),r=e(o["e"].fromDegrees(c[0],c[1])),h=e(o["e"].fromDegrees(c[0],l[1])),d=(new s["Fb"]).subVectors(r,h).normalize();u[n].threeMesh.position.copy(i),u[n].threeMesh.lookAt(a.x,a.y,a.z),u[n].threeMesh.up.copy(d)})),h.camera.matrixAutoUpdate=!1;var t=d.viewer.camera.viewMatrix,n=d.viewer.camera.inverseViewMatrix;h.camera.lookAt(0,0,0),h.camera.matrixWorld.set(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]),h.camera.matrixWorldInverse.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]);var a=i.clientWidth,r=i.clientHeight,f=a/r;h.camera.aspect=f,h.camera.updateProjectionMatrix(),h.renderer.setSize(a,r),h.renderer.clear(),h.renderer.render(h.scene,h.camera)}}},p=f,v=(n("b83b"),n("c701")),m=Object(v["a"])(p,a,r,!1,null,"46a71dbb",null);t["default"]=m.exports},"3aab":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var o=n("acc5"),s=n("4d28"),c=n.n(s);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){function e(t){i(this,e),l(this,"dimensions",["lng","lat"]),l(this,"radians",o["P"].toRadians(80)),this._GLMap=t,this._mapOffset=[0,0],this.dimensions=["lng","lat"]}return r(e,[{key:"setMapOffset",value:function(e){this._mapOffset=e}},{key:"getMap",value:function(){return this._GLMap}},{key:"fixLat",value:function(e){return e>=90?89.99999999999999:e<=-90?-89.99999999999999:e}},{key:"dataToPoint",value:function(e){var t=[99999,99999];e[1]=this.fixLat(e[1]);var n=o["e"].fromDegrees(e[0],e[1]);if(!n)return t;var i=this._GLMap.cartesianToCanvasCoordinates(n);return i?!(this._GLMap.mode===o["db"].SCENE3D&&o["e"].angleBetween(this._GLMap.camera.position,n)>this.radians)&&[i.x-this._mapOffset[0],i.y-this._mapOffset[1]]:t}},{key:"pointToData",value:function(e){this._mapOffset;var t=this._bmap.project([e[0]+e[0],e[1]+e[1]]);return[t.lng,t.lat]}},{key:"getViewRect",value:function(){var e=this._api;return new c.a.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())}},{key:"getRoamTransform",value:function(){return c.a.matrix.create()}},{key:"create",value:function(t,n){var i;this._api=n,t.eachComponent("GLMap",(function(t){var a=n.getZr().painter;if(a){var r=c.a.glMap;i=new e(r,n),i.setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=i}})),t.eachSeries((function(e){"GLMap"===e.get("coordinateSystem")&&(e.coordinateSystem=i)}))}}]),e}(),h=u;console.log(c.a);var d=function(){function e(t,n){i(this,e),this._viewer=t,this._isRegistered=!1,this._chartLayer=this._createLayerContainer(),this.option=n,this._chartLayer.setOption(n)}return r(e,[{key:"_createLayerContainer",value:function(){var e=this._viewer.scene,t=document.createElement("div");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.right="0px",t.style.bottom="0px",t.style.width=e.canvas.width+"px",t.style.height=e.canvas.height+"px",t.style.pointerEvents="none",this._viewer.container.appendChild(t),this._echartsContainer=t,c.a.glMap=e,this._register(),c.a.init(t)}},{key:"_register",value:function(){this._isRegistered||(c.a.registerCoordinateSystem("GLMap",new h(c.a.glMap)),c.a.registerAction({type:"GLMapRoam",event:"GLMapRoam",update:"updateLayout"},(function(e,t){})),c.a.extendComponentModel({type:"GLMap",getBMap:function(){return this.__GLMap},defaultOption:{roam:!1}}),c.a.extendComponentView({type:"GLMap",init:function(e,t){this.api=t,c.a.glMap.postRender.addEventListener(this.moveHandler,this)},moveHandler:function(e,t){this.api.dispatchAction({type:"GLMapRoam"})},render:function(e,t,n){},dispose:function(){c.a.glMap.postRender.removeEventListener(this.moveHandler,this)}}),this._isRegistered=!0)}},{key:"dispose",value:function(){this._echartsContainer&&(this._viewer.container.removeChild(this._echartsContainer),this._echartsContainer=null),this._chartLayer&&(this._chartLayer.dispose(),this._chartLayer=null),this._isRegistered=!1}},{key:"destroy",value:function(){this.dispose()}},{key:"updateEchartsLayer",value:function(e){this._chartLayer&&this._chartLayer.setOption(e)}},{key:"getMap",value:function(){return this._viewer}},{key:"getEchartsLayer",value:function(){return this._chartLayer}},{key:"show",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="visible")}},{key:"hide",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="hidden")}}]),e}();o["EchartsLayer"]=d},"3db9":function(e,t,n){},b83b:function(e,t,n){"use strict";n("3db9")}}]);
//# sourceMappingURL=chunk-b16eaf52.40842d81.js.map