(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-267cb951"],{"0043":function(e,t,n){},"3aab":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var o=n("acc5"),s=n("4d28"),c=n.n(s);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){function e(t){i(this,e),u(this,"dimensions",["lng","lat"]),u(this,"radians",o["P"].toRadians(80)),this._GLMap=t,this._mapOffset=[0,0],this.dimensions=["lng","lat"]}return a(e,[{key:"setMapOffset",value:function(e){this._mapOffset=e}},{key:"getMap",value:function(){return this._GLMap}},{key:"fixLat",value:function(e){return e>=90?89.99999999999999:e<=-90?-89.99999999999999:e}},{key:"dataToPoint",value:function(e){var t=[99999,99999];e[1]=this.fixLat(e[1]);var n=o["e"].fromDegrees(e[0],e[1]);if(!n)return t;var i=this._GLMap.cartesianToCanvasCoordinates(n);return i?!(this._GLMap.mode===o["db"].SCENE3D&&o["e"].angleBetween(this._GLMap.camera.position,n)>this.radians)&&[i.x-this._mapOffset[0],i.y-this._mapOffset[1]]:t}},{key:"pointToData",value:function(e){this._mapOffset;var t=this._bmap.project([e[0]+e[0],e[1]+e[1]]);return[t.lng,t.lat]}},{key:"getViewRect",value:function(){var e=this._api;return new c.a.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())}},{key:"getRoamTransform",value:function(){return c.a.matrix.create()}},{key:"create",value:function(t,n){var i;this._api=n,t.eachComponent("GLMap",(function(t){var r=n.getZr().painter;if(r){var a=c.a.glMap;i=new e(a,n),i.setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=i}})),t.eachSeries((function(e){"GLMap"===e.get("coordinateSystem")&&(e.coordinateSystem=i)}))}}]),e}(),h=l;console.log(c.a);var v=function(){function e(t,n){i(this,e),this._viewer=t,this._isRegistered=!1,this._chartLayer=this._createLayerContainer(),this.option=n,this._chartLayer.setOption(n)}return a(e,[{key:"_createLayerContainer",value:function(){var e=this._viewer.scene,t=document.createElement("div");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.right="0px",t.style.bottom="0px",t.style.width=e.canvas.width+"px",t.style.height=e.canvas.height+"px",t.style.pointerEvents="none",this._viewer.container.appendChild(t),this._echartsContainer=t,c.a.glMap=e,this._register(),c.a.init(t)}},{key:"_register",value:function(){this._isRegistered||(c.a.registerCoordinateSystem("GLMap",new h(c.a.glMap)),c.a.registerAction({type:"GLMapRoam",event:"GLMapRoam",update:"updateLayout"},(function(e,t){})),c.a.extendComponentModel({type:"GLMap",getBMap:function(){return this.__GLMap},defaultOption:{roam:!1}}),c.a.extendComponentView({type:"GLMap",init:function(e,t){this.api=t,c.a.glMap.postRender.addEventListener(this.moveHandler,this)},moveHandler:function(e,t){this.api.dispatchAction({type:"GLMapRoam"})},render:function(e,t,n){},dispose:function(){c.a.glMap.postRender.removeEventListener(this.moveHandler,this)}}),this._isRegistered=!0)}},{key:"dispose",value:function(){this._echartsContainer&&(this._viewer.container.removeChild(this._echartsContainer),this._echartsContainer=null),this._chartLayer&&(this._chartLayer.dispose(),this._chartLayer=null),this._isRegistered=!1}},{key:"destroy",value:function(){this.dispose()}},{key:"updateEchartsLayer",value:function(e){this._chartLayer&&this._chartLayer.setOption(e)}},{key:"getMap",value:function(){return this._viewer}},{key:"getEchartsLayer",value:function(){return this._chartLayer}},{key:"show",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="visible")}},{key:"hide",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="hidden")}}]),e}();o["EchartsLayer"]=v},b203:function(e,t,n){"use strict";n("0043")},de30:function(e,t,n){"use strict";n.r(t);var i,r=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"cesiumContainer1"}},[n("div",{attrs:{id:"cesiumContainer"}}),n("div",{attrs:{id:"ThreeContainer"}})])}],o=(n("3610"),n("acc5")),s=n("3bc2"),c=(n("5b17"),n("3aab"),[115.23,39.55]),u=[116.23,41.55],l=[],h={renderer:null,camera:null,scene:null},v={viewer:null},d={props:{},data:function(){return{publicPath:"",shader1:{vs:" varying vec2 vUv;\n                void main() {\n                  vUv = uv;\n                  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                }",fs:"\n          varying vec2 vUv;\n          uniform float time;\n          vec3 hsb2rgb(const vec3 c) {\n            vec3 rgb = clamp(abs(mod(c.x*6.0+vec3(0.0, 4.0, 2.0), 6.0)-3.0)-1.0, 0.0, 1.0);\n            rgb = rgb*rgb*(3.0-2.0*rgb);\n            return c.z * mix( vec3(1.0), rgb, c.y);\n          }\n          void main() {\n              // Normalized pixel coordinates (from 0 to 1)\n            vec2 uv = vUv;\n            vec2 p = 2.0*uv.xy - vec2(1., 1.) ; // center what being drawn\n            float r = length(p) * 2.;\n            vec3 color = hsb2rgb(vec3(0.24, 0.7, 0.5));\n            float a = pow(r, 2.0);\n            float b = sin(r * 0.8 - 1.6);\n            float c = sin(r - 0.010);\n            float s = sin(a - time * 3.0 + b) * c;\n            color *= abs(1.0 / (s * 30.)) - 0.01;\n            gl_FragColor = vec4(color, .4);\n          }\n          "},shader2:{vs:"\n\t\tvarying vec3 vPosition;\n\t\tvoid main(){\n\t\t\tvPosition=position;\n\t\t\tgl_Position\t= projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t}\n\t",fs:"\n\t\tvarying vec3 vPosition;\n\t\tuniform vec3 u_color;\n\t\tuniform float u_r;\n\t\tuniform float u_ring;\n\n\t\tvoid main(){\n\t\t\tfloat pct=distance(vec2(vPosition.x,vPosition.y),vec2(0.0));\n\t\t\tif(pct>u_r || pct<(u_r-u_ring)){\n\t\t\t\tgl_FragColor = vec4(1.0,0.0,0.0,0);\n\t\t\t}else{\n\t\t\t\tfloat dis=(pct-(u_r-u_ring))/(u_r-u_ring);\n\t\t\t\tgl_FragColor = vec4(u_color,dis);\n\t\t\t}\n\t\t}\n\t"}}},mounted:function(){this.main()},methods:{main:function(){o["J"].defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmMjY1MzY3MC1mYWIwLTQ2ZDItYTdlZi0yNWEyZjU2MjAzOTQiLCJpZCI6Mzg4MzUsImlhdCI6MTYwNjg3MzkxNX0.gGDAumUmOxcrCTMRfrKZJjfZpYiLxGwJwSLlkDYt9BY",document.getElementById("cesiumContainer"),i=document.getElementById("ThreeContainer"),this.initCesium(),this.initThree(),this.init3DObject(),this.loop()},initCesium:function(){new o["a"]({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),new o["nb"]({url:"http://mt1.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&{x}&y={y}&z={z}&s=Gali"});document.getElementById("cesiumContainer"),v.viewer=new o["rb"]("cesiumContainer",{infoBox:!1,selectionIndicator:!1,geocoder:!1,homeButton:!1,timeline:!1,navigationHelpButton:!1,fullscreenButton:!1,scene3DOnly:!0,animation:!1,imageryProvider:new o["a"]({url:"http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer"}),baseLayerPicker:!1});var e=o["e"].fromDegrees((c[0]+u[0])/2,(c[1]+u[1])/2-1,2e5);e,v.viewer.camera.flyTo({destination:e,orientation:{heading:o["P"].toRadians(0),pitch:o["P"].toRadians(-60),roll:o["P"].toRadians(0)},duration:3})},initThree:function(){var e=45,t=window.innerWidth,n=window.innerHeight,r=t/n,a=1,o=1e7;h.scene=new s["nb"],h.camera=new s["eb"](e,r,a,o),h.renderer=new s["Hb"]({alpha:!0}),i.appendChild(h.renderer.domElement)},init3DObject:function(){var e={name:"Polygon",polygon:{hierarchy:o["e"].fromDegreesArray([c[0],c[1],u[0],c[1],u[0],u[1],c[0],u[1]]),material:o["q"].RED.withAlpha(0)}},t=(v.viewer.entities.add(e),this.scatterCircle(1,.1,.3,new s["Fb"](0,1,1),.02));t.scale.set(5e4,5e4,5e4),t.position.z+=15;var n=new s["w"];n.add(t),h.scene.add(n);var i=new r;function r(){this.threeMesh=null,this.minWGS84=null,this.maxWGS84=null}i.threeMesh=n,i.minWGS84=c,i.maxWGS84=u,l.push(i)},scatterCircle:function(e,t,n,i,r){var a={time:{value:0},u_color:{value:i},u_r:{value:t},u_ring:{value:n}},o=this.shader2.vs,c=this.shader2.fs,u=new s["l"](e,12e3),l=new s["pb"]({vertexShader:o,fragmentShader:c,side:s["r"],uniforms:a,transparent:!0,depthWrite:!1}),h=new s["S"](u,l);function v(){a.time.value+=.01,console.log(a.time),a.u_r.value+=r||.1,a.u_r.value>=e&&(a.u_r.value=t),requestAnimationFrame(v)}return v(),h},loop:function(){requestAnimationFrame(this.loop),this.renderCesium(),this.renderThreeObj()},renderCesium:function(){v.viewer.render()},renderThreeObj:function(){h.camera.fov=o["P"].toDegrees(v.viewer.camera.frustum.fovy);var e=function(e){return new s["Fb"](e.x,e.y,e.z)};l.forEach((function(t,n){c=l[n].minWGS84,u=l[n].maxWGS84;var i=o["e"].fromDegrees((c[0]+u[0])/2,(c[1]+u[1])/2),r=o["e"].fromDegrees((c[0]+u[0])/2,(c[1]+u[1])/2,1),a=e(o["e"].fromDegrees(c[0],c[1])),h=e(o["e"].fromDegrees(c[0],u[1])),v=(new s["Fb"]).subVectors(a,h).normalize();l[n].threeMesh.position.copy(i),l[n].threeMesh.lookAt(r.x,r.y,r.z),l[n].threeMesh.up.copy(v)})),h.camera.matrixAutoUpdate=!1;var t=v.viewer.camera.viewMatrix,n=v.viewer.camera.inverseViewMatrix;h.camera.lookAt(0,0,0),h.camera.matrixWorld.set(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]),h.camera.matrixWorldInverse.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]);var r=i.clientWidth,a=i.clientHeight,d=r/a;h.camera.aspect=d,h.camera.updateProjectionMatrix(),h.renderer.setSize(r,a),h.renderer.clear(),h.renderer.render(h.scene,h.camera)}}},m=d,p=(n("b203"),n("c701")),f=Object(p["a"])(m,r,a,!1,null,"ca83c6d2",null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-267cb951.18ffd5e8.js.map