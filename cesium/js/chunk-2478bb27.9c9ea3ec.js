(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2478bb27"],{"23de":function(e,n,r){},"2fea":function(e,n,r){"use strict";r.r(n);var t,i=function(){var e=this,n=e.$createElement;e._self._c;return e._m(0)},o=[function(){var e=this,n=e.$createElement,r=e._self._c||n;return r("div",{attrs:{id:"cesiumContainer1"}},[r("div",{attrs:{id:"cesiumContainer"}}),r("div",{attrs:{id:"ThreeContainer"}})])}],a=(r("d7d9"),r("3610"),r("3bc2")),s=[],c={renderer:null,camera:null,scene:null},u={viewer:null},l={props:{},data:function(){return{}},mounted:function(){this.main()},methods:{main:function(){Cesium.Ion.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmMjY1MzY3MC1mYWIwLTQ2ZDItYTdlZi0yNWEyZjU2MjAzOTQiLCJpZCI6Mzg4MzUsImlhdCI6MTYwNjg3MzkxNX0.gGDAumUmOxcrCTMRfrKZJjfZpYiLxGwJwSLlkDYt9BY",document.getElementById("cesiumContainer"),t=document.getElementById("ThreeContainer"),this.initCesium(),this.initThree(),this.init3DObject(),this.loop()},initCesium:function(){u.viewer=new Cesium.Viewer("cesiumContainer",{useDefaultRenderLoop:!1,infoBox:!1,selectionIndicator:!1,geocoder:!1,homeButton:!1,timeline:!1,navigationHelpButton:!1,fullscreenButton:!1,scene3DOnly:!0,animation:!1,imageryProvider:new Cesium.ArcGisMapServerImageryProvider({url:"http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer"}),baseLayerPicker:!1}),u.viewer.scene.camera.flyTo({destination:new Cesium.Cartesian3(-2852038.506894064,4656753.071879653,3286786.358214652),orientation:{heading:.4417702951554947,pitch:-.30187320702800813}})},initThree:function(){var e=45,n=window.innerWidth,r=window.innerHeight,i=n/r,o=1,s=1e7;c.scene=new a["nb"],c.camera=new a["eb"](e,i,o,s),c.renderer=new a["Hb"]({alpha:!0}),t.appendChild(c.renderer.domElement)},init3DObject:function(){this.addBuildings();this.addElectBox()},loop:function(){requestAnimationFrame(this.loop),this.renderCesium(),this.renderThreeObj()},renderCesium:function(){u.viewer.render()},renderThreeObj:function(){c.camera.fov=Cesium.Math.toDegrees(u.viewer.camera.frustum.fovy),s.length>0&&s.forEach((function(e,n){s[n].threeMesh.material.uniforms.time.value+=.01})),c.camera.matrixAutoUpdate=!1;var e=u.viewer.camera.viewMatrix,n=u.viewer.camera.inverseViewMatrix;c.camera.lookAt(0,0,0),c.camera.matrixWorld.set(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]),c.camera.matrixWorldInverse.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]);var r=t.clientWidth,i=t.clientHeight,o=r/i;c.camera.aspect=o,c.camera.updateProjectionMatrix(),c.renderer.setSize(r,i),c.renderer.clear(),c.renderer.render(c.scene,c.camera)},addBuildings:function(){Cesium.TILE_EFFECT_STAYE=!0,Cesium.TILE_FS_BODY=" float stc_pl = fract(czm_frameNumber / 120.0) * 3.14159265 *         \n  2.0;\n float stc_sd = v_stcVertex.z / 60.0 + sin(stc_pl) * 0.1;\n gl_FragColor *= vec4(stc_sd, stc_sd, stc_sd, 1.0);\n float stc_a13 = fract(czm_frameNumber / 360.0);\n float stc_h = clamp(v_stcVertex.z / 450.0, 0.0, 1.0);\n stc_a13 = abs(stc_a13 - 0.5) * 2.0;\n float stc_diff = step(0.005, abs(stc_h - stc_a13));\n gl_FragColor.rgb += gl_FragColor.rgb * (1.0 - stc_diff);";var e=new Cesium.Cesium3DTileset({url:"test3/tileset.json",maximumScreenSpaceError:16,maximumNumberOfLoadedTiles:1e3});u.viewer.scene.primitives.add(e),e.readyPromise.then((function(e){console.log(e);var n=e.boundingSphere,r=Cesium.Cartographic.fromCartesian(n.center),t=Cesium.Cartesian3.fromRadians(r.longitude,r.latitude,0),i=Cesium.Cartesian3.fromRadians(Cesium.Math.toRadians(121.41440447172941),Cesium.Math.toRadians(31.148724746744023),-32),o=Cesium.Cartesian3.subtract(i,t,new Cesium.Cartesian3);e.modelMatrix=Cesium.Matrix4.fromTranslation(o),e.style=new Cesium.Cesium3DTileStyle({color:{conditions:[["true","color('cyan')"]]}})})).otherwise((function(e){throw e}))},addElectBox:function(){var e=[121.49,31.26],n=[122.49,32.26],r=this.getElectBoxMaterial(),t=new a["tb"](15,50,50,0,2*Math.PI),i=new a["S"](t,r);i.scale.set(1500,1500,1500),i.position.z+=15,i.rotation.x=Math.PI/2,c.scene.add(i);var o={threeMesh:i,minWGS84:e,maxWGS84:n};return s.push(o),this.setThreeObjPosition(o),o},getElectBoxMaterial:function(){var e={uniforms:{time:{type:"f",value:0},color:{type:"c",value:new a["n"]("red")},opacity:{type:"f",value:1}},vertexShaderSource:"\n  precision lowp float;\n  precision lowp int;\n  ".concat(a["ob"].fog_pars_vertex,"\n  varying vec2 vUv;\n  void main() {\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    ").concat(a["ob"].fog_vertex,"\n  }\n"),fragmentShaderSource:"\n                  #if __VERSION__ == 100\n                   #extension GL_OES_standard_derivatives : enable\n                  #endif\n                  uniform vec3 color;\n                  uniform float opacity;\n                  uniform float time;\n                  varying vec2 vUv;\n                  #define pi 3.1415926535\n                  #define PI2RAD 0.01745329252\n                  #define TWO_PI (2. * PI)\n                  float rands(float p){\n                      return fract(sin(p) * 10000.0);\n                  }\n                  float noise(vec2 p){\n                      float t = time / 20000.0;\n                      if(t > 1.0) t -= floor(t);\n                      return rands(p.x * 14. + p.y * sin(t) * 0.5);\n                  }\n                  vec2 sw(vec2 p){\n                      return vec2(floor(p.x), floor(p.y));\n                  }\n                  vec2 se(vec2 p){\n                      return vec2(ceil(p.x), floor(p.y));\n                  }\n                  vec2 nw(vec2 p){\n                      return vec2(floor(p.x), ceil(p.y));\n                  }\n                  vec2 ne(vec2 p){\n                      return vec2(ceil(p.x), ceil(p.y));\n                  }\n                  float smoothNoise(vec2 p){\n                      vec2 inter = smoothstep(0.0, 1.0, fract(p));\n                      float s = mix(noise(sw(p)), noise(se(p)), inter.x);\n                      float n = mix(noise(nw(p)), noise(ne(p)), inter.x);\n                      return mix(s, n, inter.y);\n                  }\n                  float fbm(vec2 p){\n                      float z = 2.0;\n                      float rz = 0.0;\n                      vec2 bp = p;\n                      for(float i = 1.0; i < 6.0; i++){\n                      rz += abs((smoothNoise(p) - 0.5)* 2.0) / z;\n                      z *= 2.0;\n                      p *= 2.0;\n                      }\n                      return rz;\n                  }\n                  void main() {\n                      vec2 uv = vUv;\n                      vec2 uv2 = vUv;\n                      if (uv.y < 0.5) {\n                      discard;\n                      }\n                      uv *= 4.;\n                      float rz = fbm(uv);\n                      uv /= exp(mod(time * 2.0, pi));\n                      rz *= pow(15., 0.9);\n                      gl_FragColor = mix(vec4(color, opacity) / rz, vec4(color, 0.1), 0.2);\n                      if (uv2.x < 0.05) {\n                      gl_FragColor = mix(vec4(color, 0.1), gl_FragColor, uv2.x / 0.05);\n                      }\n                      if (uv2.x > 0.95){\n                      gl_FragColor = mix(gl_FragColor, vec4(color, 0.1), (uv2.x - 0.95) / 0.05);\n                      }\n                  }"},n=new a["pb"]({uniforms:e.uniforms,defaultAttributeValues:{},vertexShader:e.vertexShaderSource,fragmentShader:e.fragmentShaderSource,blending:a["a"],depthWrite:!1,depthTest:!0,side:a["r"],transparent:!0});return n},setThreeObjPosition:function(e){var n=function(e){return new a["Fb"](e.x,e.y,e.z)},r=e.minWGS84,t=e.maxWGS84,i=Cesium.Cartesian3.fromDegrees((r[0]+t[0])/2,(r[1]+t[1])/2),o=Cesium.Cartesian3.fromDegrees((r[0]+t[0])/2,(r[1]+t[1])/2,1),s=n(Cesium.Cartesian3.fromDegrees(r[0],r[1])),c=n(Cesium.Cartesian3.fromDegrees(r[0],t[1])),u=(new a["Fb"]).subVectors(s,c).normalize();e.threeMesh.position.copy(i),e.threeMesh.lookAt(o.x,o.y,o.z),e.threeMesh.up.copy(u)}}},m=l,d=(r("8744"),r("c701")),f=Object(d["a"])(m,i,o,!1,null,"1964534d",null);n["default"]=f.exports},8744:function(e,n,r){"use strict";r("23de")},bab6:function(e,n,r){"use strict";var t=r("bab3"),i=r("30cf"),o=r("ef69");e.exports=function(e,n,r){var a=t(n);a in e?i.f(e,a,o(0,r)):e[a]=r}},d7d9:function(e,n,r){"use strict";var t=r("485e"),i=r("aad0"),o=r("880d"),a=r("3b29"),s=r("3c6b"),c=r("4a35"),u=r("bab6"),l=r("0c3a"),m=r("243e"),d=r("6d05"),f=r("7047"),v=d("isConcatSpreadable"),p=9007199254740991,h="Maximum allowed index exceeded",C=f>=51||!i((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),g=m("concat"),x=function(e){if(!a(e))return!1;var n=e[v];return void 0!==n?!!n:o(e)},w=!C||!g;t({target:"Array",proto:!0,forced:w},{concat:function(e){var n,r,t,i,o,a=s(this),m=l(a,0),d=0;for(n=-1,t=arguments.length;n<t;n++)if(o=-1===n?a:arguments[n],x(o)){if(i=c(o.length),d+i>p)throw TypeError(h);for(r=0;r<i;r++,d++)r in o&&u(m,d,o[r])}else{if(d>=p)throw TypeError(h);u(m,d++,o)}return m.length=d,m}})}}]);
//# sourceMappingURL=chunk-2478bb27.9c9ea3ec.js.map