(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-687b852c"],{"06b2":function(e,t,n){"use strict";var i=n("b804"),r=n("21e0");e.exports="".repeat||function(e){var t=String(r(this)),n="",a=i(e);if(a<0||a==1/0)throw RangeError("Wrong number of repetitions");for(;a>0;(a>>>=1)&&(t+=t))1&a&&(n+=t);return n}},"3aab":function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}var s=n("acc5"),o=n("4d28"),c=n.n(o);function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(){function e(t){i(this,e),u(this,"dimensions",["lng","lat"]),u(this,"radians",s["P"].toRadians(80)),this._GLMap=t,this._mapOffset=[0,0],this.dimensions=["lng","lat"]}return a(e,[{key:"setMapOffset",value:function(e){this._mapOffset=e}},{key:"getMap",value:function(){return this._GLMap}},{key:"fixLat",value:function(e){return e>=90?89.99999999999999:e<=-90?-89.99999999999999:e}},{key:"dataToPoint",value:function(e){var t=[99999,99999];e[1]=this.fixLat(e[1]);var n=s["e"].fromDegrees(e[0],e[1]);if(!n)return t;var i=this._GLMap.cartesianToCanvasCoordinates(n);return i?!(this._GLMap.mode===s["db"].SCENE3D&&s["e"].angleBetween(this._GLMap.camera.position,n)>this.radians)&&[i.x-this._mapOffset[0],i.y-this._mapOffset[1]]:t}},{key:"pointToData",value:function(e){this._mapOffset;var t=this._bmap.project([e[0]+e[0],e[1]+e[1]]);return[t.lng,t.lat]}},{key:"getViewRect",value:function(){var e=this._api;return new c.a.graphic.BoundingRect(0,0,e.getWidth(),e.getHeight())}},{key:"getRoamTransform",value:function(){return c.a.matrix.create()}},{key:"create",value:function(t,n){var i;this._api=n,t.eachComponent("GLMap",(function(t){var r=n.getZr().painter;if(r){var a=c.a.glMap;i=new e(a,n),i.setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=i}})),t.eachSeries((function(e){"GLMap"===e.get("coordinateSystem")&&(e.coordinateSystem=i)}))}}]),e}(),l=h;console.log(c.a);var p=function(){function e(t,n){i(this,e),this._viewer=t,this._isRegistered=!1,this._chartLayer=this._createLayerContainer(),this.option=n,this._chartLayer.setOption(n)}return a(e,[{key:"_createLayerContainer",value:function(){var e=this._viewer.scene,t=document.createElement("div");return t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.right="0px",t.style.bottom="0px",t.style.width=e.canvas.width+"px",t.style.height=e.canvas.height+"px",t.style.pointerEvents="none",this._viewer.container.appendChild(t),this._echartsContainer=t,c.a.glMap=e,this._register(),c.a.init(t)}},{key:"_register",value:function(){this._isRegistered||(c.a.registerCoordinateSystem("GLMap",new l(c.a.glMap)),c.a.registerAction({type:"GLMapRoam",event:"GLMapRoam",update:"updateLayout"},(function(e,t){})),c.a.extendComponentModel({type:"GLMap",getBMap:function(){return this.__GLMap},defaultOption:{roam:!1}}),c.a.extendComponentView({type:"GLMap",init:function(e,t){this.api=t,c.a.glMap.postRender.addEventListener(this.moveHandler,this)},moveHandler:function(e,t){this.api.dispatchAction({type:"GLMapRoam"})},render:function(e,t,n){},dispose:function(){c.a.glMap.postRender.removeEventListener(this.moveHandler,this)}}),this._isRegistered=!0)}},{key:"dispose",value:function(){this._echartsContainer&&(this._viewer.container.removeChild(this._echartsContainer),this._echartsContainer=null),this._chartLayer&&(this._chartLayer.dispose(),this._chartLayer=null),this._isRegistered=!1}},{key:"destroy",value:function(){this.dispose()}},{key:"updateEchartsLayer",value:function(e){this._chartLayer&&this._chartLayer.setOption(e)}},{key:"getMap",value:function(){return this._viewer}},{key:"getEchartsLayer",value:function(){return this._chartLayer}},{key:"show",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="visible")}},{key:"hide",value:function(){this._echartsContainer&&(this._echartsContainer.style.visibility="hidden")}}]),e}();s["EchartsLayer"]=p},"3f87":function(e,t,n){"use strict";n("47dd")},"47dd":function(e,t,n){},"63fc":function(e,t,n){"use strict";n.r(t);var i,r,a=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"cesiumContainer1"}},[n("div",{attrs:{id:"cesiumContainer"}}),n("div",{attrs:{id:"ThreeContainer"}})])}],o=(n("3610"),n("1564"),n("c585"),n("7863"),n("acc5")),c=n("3bc2"),u=(n("5b17"),n("3aab"),[115.23,39.55]),h=[116.23,41.55],l=[],p={renderer:null,camera:null,scene:null},d={viewer:null},f={props:{},data:function(){return{publicPath:""}},mounted:function(){this.main()},methods:{main:function(){o["J"].defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiJmMjY1MzY3MC1mYWIwLTQ2ZDItYTdlZi0yNWEyZjU2MjAzOTQiLCJpZCI6Mzg4MzUsImlhdCI6MTYwNjg3MzkxNX0.gGDAumUmOxcrCTMRfrKZJjfZpYiLxGwJwSLlkDYt9BY",document.getElementById("cesiumContainer"),i=document.getElementById("ThreeContainer"),this.initCesium(),this.initThree(),this.init3DObject(),this.loop()},initCesium:function(){new o["a"]({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer"}),new o["nb"]({url:"http://mt1.google.cn/vt/lyrs=s&hl=zh-CN&x={x}&{x}&y={y}&z={z}&s=Gali"});d.viewer=new o["rb"]("cesiumContainer",{infoBox:!1,selectionIndicator:!1,geocoder:!1,homeButton:!1,timeline:!1,navigationHelpButton:!1,fullscreenButton:!1,scene3DOnly:!0,animation:!1,imageryProvider:new o["a"]({url:"http://cache1.arcgisonline.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer"}),baseLayerPicker:!1});var e=o["e"].fromDegrees((u[0]+h[0])/2,(u[1]+h[1])/2-1,2e5);e,d.viewer.camera.flyTo({destination:e,orientation:{heading:o["P"].toRadians(0),pitch:o["P"].toRadians(-60),roll:o["P"].toRadians(0)},duration:3})},initThree:function(){var e=45,t=window.innerWidth,n=window.innerHeight,r=t/n,a=1,s=1e7;p.scene=new c["nb"],p.camera=new c["eb"](e,r,a,s),p.renderer=new c["Hb"]({alpha:!0}),i.appendChild(p.renderer.domElement)},init3DObject:function(){var e={name:"Polygon",polygon:{hierarchy:o["e"].fromDegreesArray([u[0],u[1],h[0],u[1],h[0],h[1],u[0],h[1]]),material:o["q"].RED.withAlpha(0)}},t=(d.viewer.entities.add(e),this.createMesh());t.scale.set(1500,1500,1500),t.position.z+=15,t.rotation.x=Math.PI/2;var n=new c["w"];n.add(t),p.scene.add(n);var i=new r;function r(){this.threeMesh=null,this.minWGS84=null,this.maxWGS84=null}i.threeMesh=n,i.minWGS84=u,i.maxWGS84=h,l.push(i)},createMesh:function(){r=(new c["Ab"]).load("".concat(this.publicPath,"texture/nanshan-road1.png")),r.wrapS=r.wrapT=c["mb"],r.repeat.set(1,1),r.needsUpdate=!0,r.offset.x=.5;var e=new c["T"]({map:r,side:c["d"],transparent:!0}),t=[new c["Fb"](0,0,0),new c["Fb"](10,0,0),new c["Fb"](10,0,10),new c["Fb"](0,0,10)],n=new c["k"](t),i=new c["Db"](n,80,.1),a=new c["S"](i,e);return a},getTexture:function(){var e=this;return new Promise((function(t,n){(new c["Ab"]).load("".concat(e.publicPath,"texture/nanshan-road1.png"),(function(e){t(e)}),void 0,void 0)}))},loop:function(){requestAnimationFrame(this.loop),this.renderCesium(),this.renderThreeObj()},renderCesium:function(){d.viewer.render()},renderThreeObj:function(){p.camera.fov=o["P"].toDegrees(d.viewer.camera.frustum.fovy);var e=function(e){return new c["Fb"](e.x,e.y,e.z)};l.forEach((function(t,n){u=l[n].minWGS84,h=l[n].maxWGS84;var i=o["e"].fromDegrees((u[0]+h[0])/2,(u[1]+h[1])/2),r=o["e"].fromDegrees((u[0]+h[0])/2,(u[1]+h[1])/2,1),a=e(o["e"].fromDegrees(u[0],u[1])),s=e(o["e"].fromDegrees(u[0],h[1])),p=(new c["Fb"]).subVectors(a,s).normalize();l[n].threeMesh.position.copy(i),l[n].threeMesh.lookAt(r.x,r.y,r.z),l[n].threeMesh.up.copy(p),l[n].threeMesh.children[0].material.map.offset.x-=.01})),p.camera.matrixAutoUpdate=!1;var t=d.viewer.camera.viewMatrix,n=d.viewer.camera.inverseViewMatrix;p.camera.lookAt(0,0,0),p.camera.matrixWorld.set(n[0],n[4],n[8],n[12],n[1],n[5],n[9],n[13],n[2],n[6],n[10],n[14],n[3],n[7],n[11],n[15]),p.camera.matrixWorldInverse.set(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15]);var r=i.clientWidth,a=i.clientHeight,s=r/a;p.camera.aspect=s,p.camera.updateProjectionMatrix(),p.renderer.setSize(r,a),p.renderer.clear(),p.renderer.render(p.scene,p.camera)}}},m=f,v=(n("3f87"),n("c701")),y=Object(v["a"])(m,a,s,!1,null,"15b0feb1",null);t["default"]=y.exports},7863:function(e,t,n){var i=n("485e"),r=n("06b2");i({target:"String",proto:!0},{repeat:r})}}]);
//# sourceMappingURL=chunk-687b852c.e6612c26.js.map